--[[
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                                                                               â•‘
    â•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—    â•‘
    â•‘   â–ˆâ–ˆâ•”â•â•â•â•â•â•šâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•    â•‘
    â•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—    â•‘
    â•‘   â•šâ•â•â•â•â–ˆâ–ˆâ•‘  â•šâ–ˆâ–ˆâ•”â•  â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•  â•šâ•â•â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ•â•â•â•â–ˆâ–ˆâ•‘    â•‘
    â•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘    â•‘
    â•‘   â•šâ•â•â•â•â•â•â•   â•šâ•â•   â•šâ•â•  â•šâ•â•â•â•   â•šâ•â•   â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â•â•â•šâ•â•â•šâ•â•â•â•â•â•â•    â•‘
    â•‘                                                                               â•‘
    â•‘                    Cross-Platform UI Library v2.0.0                           â•‘
    â•‘                                                                               â•‘
    â•‘   â€¢ Mobile-First Design with PC Compatibility                                 â•‘
    â•‘   â€¢ Long-Press / Swipe = Right-Click Alternative                              â•‘
    â•‘   â€¢ Auto UI Scaling for Touch Devices                                         â•‘
    â•‘   â€¢ Config System with Position Memory                                        â•‘
    â•‘   â€¢ Notification System with Stack Animation                                  â•‘
    â•‘   â€¢ Panic Unload / Self-Destruct                                              â•‘
    â•‘                                                                               â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
]]

-- â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
-- â•‘                      SERVICES                                 â•‘
-- â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local CoreGui = game:GetService("CoreGui")
local HttpService = game:GetService("HttpService")
local HapticService = game:GetService("HapticService")

local LocalPlayer = Players.LocalPlayer

-- â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
-- â•‘                    MAIN LIBRARY TABLE                         â•‘
-- â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

local Synthesis = {
    Version = "2.0.0",
    Author = "Synthesis Team",
    
    -- å­˜å‚¨
    Windows = {},
    Connections = {},
    Flags = {},
    Keybinds = {},
    
    -- çŠ¶æ€
    _initialized = false,
    _savedPositions = {},
    _unloaded = false
}

-- â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
-- â•‘                   PLATFORM DETECTION                          â•‘
-- â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

local Platform = {
    IsMobile = UserInputService.TouchEnabled and not UserInputService.KeyboardEnabled,
    IsPC = UserInputService.KeyboardEnabled and UserInputService.MouseEnabled,
    IsConsole = UserInputService.GamepadEnabled and not UserInputService.KeyboardEnabled,
    IsTablet = UserInputService.TouchEnabled and UserInputService.KeyboardEnabled
}

-- ç§»åŠ¨ç«¯UIæ”¾å¤§20%
Platform.ScaleFactor = Platform.IsMobile and 1.2 or 1.0
Platform.DeviceName = Platform.IsMobile and "Mobile" or (Platform.IsConsole and "Console" or "PC")

Synthesis.Platform = Platform

-- â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
-- â•‘                      ICON LIBRARY                             â•‘
-- â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Synthesis.Icons = {
    -- åŸºç¡€å›¾æ ‡
    Settings = "rbxassetid://10734950309",
    Search = "rbxassetid://10734953166",
    Close = "rbxassetid://10734954486",
    Minimize = "rbxassetid://10709791437",
    Maximize = "rbxassetid://10709792280",
    Check = "rbxassetid://10709790523",
    
    -- ç®­å¤´
    ChevronRight = "rbxassetid://10709771423",
    ChevronDown = "rbxassetid://10709771198",
    ChevronLeft = "rbxassetid://10709771283",
    ChevronUp = "rbxassetid://10709771550",
    
    -- åŠŸèƒ½å›¾æ ‡
    Key = "rbxassetid://10734902006",
    Power = "rbxassetid://10747373176",
    Trash = "rbxassetid://10709788613",
    Save = "rbxassetid://10709792113",
    Folder = "rbxassetid://10709778823",
    Refresh = "rbxassetid://10709792480",
    
    -- çŠ¶æ€å›¾æ ‡
    Warning = "rbxassetid://10709793710",
    Error = "rbxassetid://10709778263",
    Info = "rbxassetid://10709779950",
    Success = "rbxassetid://10709790523",
}

-- â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
-- â•‘                      THEME CONFIG                             â•‘
-- â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Synthesis.Theme = {
    -- ä¸»è‰²è°ƒ
    Primary = Color3.fromRGB(100, 100, 255),
    PrimaryDark = Color3.fromRGB(70, 70, 200),
    Secondary = Color3.fromRGB(60, 60, 180),
    Accent = Color3.fromRGB(130, 100, 255),
    
    -- èƒŒæ™¯è‰²
    Background = Color3.fromRGB(18, 18, 28),
    Surface = Color3.fromRGB(28, 28, 42),
    SurfaceLight = Color3.fromRGB(42, 42, 60),
    SurfaceLighter = Color3.fromRGB(55, 55, 75),
    
    -- æ–‡å­—è‰²
    TextPrimary = Color3.fromRGB(255, 255, 255),
    TextSecondary = Color3.fromRGB(180, 180, 200),
    TextMuted = Color3.fromRGB(120, 120, 140),
    
    -- çŠ¶æ€è‰²
    Success = Color3.fromRGB(80, 200, 120),
    Warning = Color3.fromRGB(255, 180, 50),
    Error = Color3.fromRGB(255, 80, 80),
    Info = Color3.fromRGB(80, 180, 255),
    
    -- åŠ¨ç”»é…ç½®
    AnimationSpeed = 0.3,
    AnimationSpeedFast = 0.15,
    AnimationSpeedSlow = 0.5,
    EasingStyle = Enum.EasingStyle.Quart,
}

-- â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
-- â•‘                    UTILITY FUNCTIONS                          â•‘
-- â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

local Utils = {}

-- å®‰å…¨æ‰§è¡Œ
function Utils.SafeCall(func, ...)
    local success, result = pcall(func, ...)
    if not success then
        warn("[Synthesis] Error:", result)
    end
    return success, result
end

-- åˆ›å»º Tween åŠ¨ç”»
function Utils.Tween(instance, properties, duration, style, direction)
    if not instance or not instance.Parent then return end
    
    local tween = TweenService:Create(
        instance,
        TweenInfo.new(
            duration or Synthesis.Theme.AnimationSpeed,
            style or Synthesis.Theme.EasingStyle,
            direction or Enum.EasingDirection.Out
        ),
        properties
    )
    tween:Play()
    return tween
end

-- åˆ›å»ºåœ†è§’
function Utils.ApplyCorner(instance, radius)
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, radius or 8)
    corner.Parent = instance
    return corner
end

-- åˆ›å»ºæè¾¹
function Utils.ApplyStroke(instance, color, thickness, transparency)
    local stroke = Instance.new("UIStroke")
    stroke.Color = color or Synthesis.Theme.Primary
    stroke.Thickness = thickness or 1
    stroke.Transparency = transparency or 0.5
    stroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    stroke.Parent = instance
    return stroke
end

-- åˆ›å»ºé˜´å½±
function Utils.ApplyShadow(instance)
    local shadow = Instance.new("ImageLabel")
    shadow.Name = "Shadow"
    shadow.Size = UDim2.new(1, 47, 1, 47)
    shadow.Position = UDim2.new(0.5, 0, 0.5, 4)
    shadow.AnchorPoint = Vector2.new(0.5, 0.5)
    shadow.BackgroundTransparency = 1
    shadow.Image = "rbxassetid://6015897843"
    shadow.ImageColor3 = Color3.new(0, 0, 0)
    shadow.ImageTransparency = 0.5
    shadow.ScaleType = Enum.ScaleType.Slice
    shadow.SliceCenter = Rect.new(49, 49, 450, 450)
    shadow.ZIndex = -10
    shadow.Parent = instance
    return shadow
end

-- åˆ›å»ºæ¸å˜
function Utils.ApplyGradient(instance, colorStart, colorEnd, rotation)
    local gradient = Instance.new("UIGradient")
    gradient.Color = ColorSequence.new({
        ColorSequenceKeypoint.new(0, colorStart or Synthesis.Theme.Primary),
        ColorSequenceKeypoint.new(1, colorEnd or Synthesis.Theme.PrimaryDark)
    })
    gradient.Rotation = rotation or 90
    gradient.Parent = instance
    return gradient
end

-- åˆ›å»ºæ¶Ÿæ¼ªæ•ˆæœ
function Utils.CreateRipple(parent, position)
    local ripple = Instance.new("Frame")
    ripple.Name = "Ripple"
    ripple.BackgroundColor3 = Color3.new(1, 1, 1)
    ripple.BackgroundTransparency = 0.7
    ripple.BorderSizePixel = 0
    ripple.ZIndex = 100
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(1, 0)
    corner.Parent = ripple
    
    -- è®¡ç®—ç›¸å¯¹ä½ç½®
    local relativeX = position.X - parent.AbsolutePosition.X
    local relativeY = position.Y - parent.AbsolutePosition.Y
    
    ripple.Size = UDim2.new(0, 0, 0, 0)
    ripple.Position = UDim2.new(0, relativeX, 0, relativeY)
    ripple.AnchorPoint = Vector2.new(0.5, 0.5)
    ripple.Parent = parent
    
    -- åŠ¨ç”»
    local maxSize = math.max(parent.AbsoluteSize.X, parent.AbsoluteSize.Y) * 2
    
    Utils.Tween(ripple, {
        Size = UDim2.new(0, maxSize, 0, maxSize),
        BackgroundTransparency = 1
    }, 0.5)
    
    task.delay(0.5, function()
        if ripple and ripple.Parent then
            ripple:Destroy()
        end
    end)
end

-- ç”Ÿæˆå”¯ä¸€ID
function Utils.GenerateUID()
    return HttpService:GenerateGUID(false):sub(1, 8)
end

Synthesis.Utils = Utils

-- â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
-- â•‘                 CONFIG MANAGER (V2)                           â•‘
-- â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

local ConfigManager = {
    ConfigFolder = "Synthesis",
    ConfigPath = ""
}

function ConfigManager:Init(configName)
    self.ConfigPath = self.ConfigFolder .. "/" .. tostring(configName or "default") .. ".json"
    
    -- åˆ›å»ºæ–‡ä»¶å¤¹
    Utils.SafeCall(function()
        if isfolder and not isfolder(self.ConfigFolder) then
            makefolder(self.ConfigFolder)
        end
    end)
end

function ConfigManager:Save(data)
    local saveData = {
        Flags = data.Flags or {},
        WindowPositions = data.WindowPositions or {},
        Keybinds = data.Keybinds or {},
        Theme = data.Theme or {},
        LastSaved = os.time(),
        Version = Synthesis.Version
    }
    
    local success = Utils.SafeCall(function()
        if writefile then
            writefile(self.ConfigPath, HttpService:JSONEncode(saveData))
        end
    end)
    
    return success
end

function ConfigManager:Load()
    local data = nil
    
    Utils.SafeCall(function()
        if isfile and isfile(self.ConfigPath) then
            local content = readfile(self.ConfigPath)
            data = HttpService:JSONDecode(content)
        end
    end)
    
    return data
end

function ConfigManager:Delete()
    Utils.SafeCall(function()
        if isfile and isfile(self.ConfigPath) then
            delfile(self.ConfigPath)
        end
    end)
end

function ConfigManager:Exists()
    local exists = false
    Utils.SafeCall(function()
        if isfile then
            exists = isfile(self.ConfigPath)
        end
    end)
    return exists
end

Synthesis.ConfigManager = ConfigManager

-- â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
-- â•‘              INPUT HANDLER (Cross-Platform)                   â•‘
-- â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

local InputHandler = {}

-- é…ç½®
local LONG_PRESS_DURATION = 0.5  -- é•¿æŒ‰è§¦å‘æ—¶é—´(ç§’)
local SWIPE_THRESHOLD = 50       -- æ»‘åŠ¨è·ç¦»é˜ˆå€¼(åƒç´ )
local DRAG_THRESHOLD = 5         -- æ‹–æ‹½è§¦å‘é˜ˆå€¼

--[[
    ç»‘å®šæŒ‰é’®äº¤äº’
    PC: å·¦é”® = onClick, å³é”® = onRightClick
    Mobile: ç‚¹å‡» = onClick, é•¿æŒ‰/å·¦æ»‘ = onRightClick
]]
function InputHandler.BindButton(element, onClick, onRightClick)
    local connections = {}
    
    if Platform.IsMobile then
        -- ==================== ç§»åŠ¨ç«¯äº¤äº’ ====================
        local pressStartTime = 0
        local pressStartPos = Vector2.new()
        local longPressTriggered = false
        local swipeTriggered = false
        
        connections.Began = element.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.Touch then
                pressStartTime = tick()
                pressStartPos = input.Position
                longPressTriggered = false
                swipeTriggered = false
                
                -- é•¿æŒ‰æ£€æµ‹åç¨‹
                task.spawn(function()
                    local startTime = pressStartTime
                    task.wait(LONG_PRESS_DURATION)
                    
                    if pressStartTime == startTime and not longPressTriggered and not swipeTriggered then
                        longPressTriggered = true
                        
                        -- è§¦è§‰åé¦ˆ
                        Utils.SafeCall(function()
                            HapticService:SetMotor(
                                Enum.UserInputType.Gamepad1,
                                Enum.VibrationMotor.Small,
                                0.5
                            )
                            task.wait(0.1)
                            HapticService:SetMotor(
                                Enum.UserInputType.Gamepad1,
                                Enum.VibrationMotor.Small,
                                0
                            )
                        end)
                        
                        -- è§¦å‘å³é”®å›è°ƒ
                        if onRightClick then
                            onRightClick()
                        end
                    end
                end)
            end
        end)
        
        connections.Changed = element.InputChanged:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.Touch and pressStartTime > 0 then
                local delta = input.Position - pressStartPos
                
                -- æ£€æµ‹å·¦æ»‘
                if not swipeTriggered and delta.X < -SWIPE_THRESHOLD and math.abs(delta.Y) < SWIPE_THRESHOLD / 2 then
                    swipeTriggered = true
                    longPressTriggered = true  -- é˜»æ­¢é•¿æŒ‰è§¦å‘
                    
                    if onRightClick then
                        onRightClick()
                    end
                end
            end
        end)
        
        connections.Ended = element.InputEnded:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.Touch then
                local pressDuration = tick() - pressStartTime
                local delta = input.Position - pressStartPos
                
                -- çŸ­æŒ‰ä¸”æœªæ»‘åŠ¨/é•¿æŒ‰ = å•å‡»
                if not longPressTriggered and not swipeTriggered then
                    if pressDuration < LONG_PRESS_DURATION and delta.Magnitude < 15 then
                        if onClick then
                            -- æ¶Ÿæ¼ªæ•ˆæœ
                            if element:FindFirstChild("Background") then
                                Utils.CreateRipple(element.Background, input.Position)
                            end
                            onClick()
                        end
                    end
                end
                
                pressStartTime = 0
            end
        end)
        
    else
        -- ==================== PCç«¯äº¤äº’ ====================
        connections.Input = element.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                if onClick then
                    onClick()
                end
            elseif input.UserInputType == Enum.UserInputType.MouseButton2 then
                if onRightClick then
                    onRightClick()
                end
            end
        end)
        
        -- æ‚¬åœæ•ˆæœ
        connections.Enter = element.MouseEnter:Connect(function()
            if element:FindFirstChild("Background") then
                Utils.Tween(element.Background, {
                    BackgroundColor3 = Synthesis.Theme.SurfaceLight
                }, 0.15)
            end
        end)
        
        connections.Leave = element.MouseLeave:Connect(function()
            if element:FindFirstChild("Background") then
                Utils.Tween(element.Background, {
                    BackgroundColor3 = Synthesis.Theme.Surface
                }, 0.15)
            end
        end)
    end
    
    return connections
end

--[[
    ç»‘å®šæ‹–æ‹½åŠŸèƒ½ (å…¼å®¹è§¦æ‘¸å’Œé¼ æ ‡)
    @param element: æ‹–æ‹½è§¦å‘åŒºåŸŸ
    @param target: è¦ç§»åŠ¨çš„ç›®æ ‡å…ƒç´ 
    @param onDragEnd: æ‹–æ‹½ç»“æŸå›è°ƒ
]]
function InputHandler.BindDrag(element, target, onDragEnd)
    target = target or element
    local connections = {}
    
    local dragging = false
    local dragStart = Vector2.new()
    local startPos = UDim2.new()
    
    connections.Began = element.InputBegan:Connect(function(input)
        local validInput = input.UserInputType == Enum.UserInputType.MouseButton1 
            or input.UserInputType == Enum.UserInputType.Touch
        
        if validInput then
            dragging = true
            dragStart = input.Position
            startPos = target.Position
        end
    end)
    
    connections.Changed = UserInputService.InputChanged:Connect(function(input)
        local validInput = input.UserInputType == Enum.UserInputType.MouseMovement 
            or input.UserInputType == Enum.UserInputType.Touch
        
        if dragging and validInput then
            local delta = input.Position - dragStart
            
            -- åªæœ‰è¶…è¿‡é˜ˆå€¼æ‰å¼€å§‹ç§»åŠ¨ (é˜²æ­¢è¯¯è§¦)
            if delta.Magnitude > DRAG_THRESHOLD then
                local newPosition = UDim2.new(
                    startPos.X.Scale,
                    startPos.X.Offset + delta.X,
                    startPos.Y.Scale,
                    startPos.Y.Offset + delta.Y
                )
                
                target.Position = newPosition
            end
        end
    end)
    
    connections.Ended = UserInputService.InputEnded:Connect(function(input)
        local validInput = input.UserInputType == Enum.UserInputType.MouseButton1 
            or input.UserInputType == Enum.UserInputType.Touch
        
        if validInput and dragging then
            dragging = false
            
            if onDragEnd then
                onDragEnd(target.Position)
            end
        end
    end)
    
    return connections
end

--[[
    åº”ç”¨ç§»åŠ¨ç«¯ç¼©æ”¾åˆ°å…ƒç´ åˆ—è¡¨
]]
function InputHandler.ApplyMobileScaling(elements)
    if not Platform.IsMobile then return end
    
    local scaleFactor = Platform.ScaleFactor
    
    for _, element in ipairs(elements) do
        if element:IsA("GuiObject") then
            local currentSize = element.Size
            element.Size = UDim2.new(
                currentSize.X.Scale * scaleFactor,
                currentSize.X.Offset * scaleFactor,
                currentSize.Y.Scale * scaleFactor,
                currentSize.Y.Offset * scaleFactor
            )
        end
    end
end

Synthesis.InputHandler = InputHandler

-- â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
-- â•‘                  NOTIFICATION SYSTEM                          â•‘
-- â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

local NotificationSystem = {
    Container = nil,
    ActiveNotifications = {},
    MaxNotifications = 5
}

-- é…ç½®
local NOTIF_WIDTH = 320
local NOTIF_HEIGHT = 85
local NOTIF_MARGIN = 10
local SCREEN_MARGIN = 20

function NotificationSystem:Init(parent)
    -- åˆ›å»ºå®¹å™¨
    self.Container = Instance.new("Frame")
    self.Container.Name = "NotificationContainer"
    self.Container.BackgroundTransparency = 1
    self.Container.Size = UDim2.new(0, NOTIF_WIDTH + 50, 1, 0)
    self.Container.Position = UDim2.new(1, -SCREEN_MARGIN, 0, 0)
    self.Container.AnchorPoint = Vector2.new(1, 0)
    self.Container.ClipsDescendants = false
    self.Container.ZIndex = 1000
    self.Container.Parent = parent
end

function NotificationSystem:Send(title, content, duration, imageId)
    if Synthesis._unloaded then return end
    
    duration = duration or 4
    
    -- é™åˆ¶æœ€å¤§é€šçŸ¥æ•°é‡
    while #self.ActiveNotifications >= self.MaxNotifications do
        local oldest = table.remove(self.ActiveNotifications, 1)
        if oldest and oldest.Instance and oldest.Instance.Parent then
            oldest.Instance:Destroy()
        end
    end
    
    -- è®¡ç®—ä½ç½®
    local yOffset = SCREEN_MARGIN
    for _, notif in ipairs(self.ActiveNotifications) do
        if notif.Instance and notif.Instance.Parent then
            yOffset = yOffset + notif.Height + NOTIF_MARGIN
        end
    end
    
    -- ==================== åˆ›å»ºé€šçŸ¥UI ====================
    
    local notification = Instance.new("CanvasGroup")
    notification.Name = "Notification_" .. Utils.GenerateUID()
    notification.Size = UDim2.new(0, NOTIF_WIDTH, 0, NOTIF_HEIGHT)
    notification.Position = UDim2.new(0, 50, 1, -yOffset - NOTIF_HEIGHT)  -- ä»å³ä¾§å¤–å¼€å§‹
    notification.BackgroundTransparency = 1
    notification.GroupTransparency = 1
    notification.ZIndex = 1000
    notification.Parent = self.Container
    
    -- é˜´å½±
    Utils.ApplyShadow(notification)
    
    -- èƒŒæ™¯å¡ç‰‡
    local card = Instance.new("Frame")
    card.Name = "Card"
    card.Size = UDim2.new(1, 0, 1, 0)
    card.BackgroundColor3 = Synthesis.Theme.Surface
    card.BorderSizePixel = 0
    card.Parent = notification
    Utils.ApplyCorner(card, 12)
    Utils.ApplyStroke(card, Synthesis.Theme.Primary, 1, 0.6)
    
    -- å·¦ä¾§è£…é¥°æ¡
    local accent = Instance.new("Frame")
    accent.Name = "Accent"
    accent.Size = UDim2.new(0, 4, 1, -16)
    accent.Position = UDim2.new(0, 8, 0.5, 0)
    accent.AnchorPoint = Vector2.new(0, 0.5)
    accent.BackgroundColor3 = Synthesis.Theme.Primary
    accent.BorderSizePixel = 0
    accent.Parent = card
    Utils.ApplyCorner(accent, 2)
    
    -- å›¾æ ‡
    local contentOffset = 20
    if imageId and imageId ~= "" then
        local iconContainer = Instance.new("Frame")
        iconContainer.Name = "IconContainer"
        iconContainer.Size = UDim2.new(0, 50, 0, 50)
        iconContainer.Position = UDim2.new(0, 20, 0.5, 0)
        iconContainer.AnchorPoint = Vector2.new(0, 0.5)
        iconContainer.BackgroundColor3 = Synthesis.Theme.SurfaceLight
        iconContainer.Parent = card
        Utils.ApplyCorner(iconContainer, 10)
        
        local icon = Instance.new("ImageLabel")
        icon.Name = "Icon"
        icon.Size = UDim2.new(1, -4, 1, -4)
        icon.Position = UDim2.new(0.5, 0, 0.5, 0)
        icon.AnchorPoint = Vector2.new(0.5, 0.5)
        icon.BackgroundTransparency = 1
        icon.Image = imageId
        icon.ScaleType = Enum.ScaleType.Crop
        icon.Parent = iconContainer
        Utils.ApplyCorner(icon, 8)
        
        contentOffset = 80
    end
    
    -- æ ‡é¢˜
    local titleLabel = Instance.new("TextLabel")
    titleLabel.Name = "Title"
    titleLabel.Size = UDim2.new(1, -contentOffset - 15, 0, 22)
    titleLabel.Position = UDim2.new(0, contentOffset, 0, 15)
    titleLabel.BackgroundTransparency = 1
    titleLabel.Text = title or "Notification"
    titleLabel.TextColor3 = Synthesis.Theme.TextPrimary
    titleLabel.TextSize = 15
    titleLabel.Font = Enum.Font.GothamBold
    titleLabel.TextXAlignment = Enum.TextXAlignment.Left
    titleLabel.TextTruncate = Enum.TextTruncate.AtEnd
    titleLabel.Parent = card
    
    -- å†…å®¹
    local contentLabel = Instance.new("TextLabel")
    contentLabel.Name = "Content"
    contentLabel.Size = UDim2.new(1, -contentOffset - 15, 0, 32)
    contentLabel.Position = UDim2.new(0, contentOffset, 0, 38)
    contentLabel.BackgroundTransparency = 1
    contentLabel.Text = content or ""
    contentLabel.TextColor3 = Synthesis.Theme.TextSecondary
    contentLabel.TextSize = 13
    contentLabel.Font = Enum.Font.Gotham
    contentLabel.TextXAlignment = Enum.TextXAlignment.Left
    contentLabel.TextWrapped = true
    contentLabel.TextTruncate = Enum.TextTruncate.AtEnd
    contentLabel.Parent = card
    
    -- è¿›åº¦æ¡
    local progressBg = Instance.new("Frame")
    progressBg.Name = "ProgressBg"
    progressBg.Size = UDim2.new(1, -16, 0, 3)
    progressBg.Position = UDim2.new(0.5, 0, 1, -8)
    progressBg.AnchorPoint = Vector2.new(0.5, 0)
    progressBg.BackgroundColor3 = Synthesis.Theme.SurfaceLight
    progressBg.BorderSizePixel = 0
    progressBg.Parent = card
    Utils.ApplyCorner(progressBg, 2)
    
    local progressBar = Instance.new("Frame")
    progressBar.Name = "Progress"
    progressBar.Size = UDim2.new(1, 0, 1, 0)
    progressBar.BackgroundColor3 = Synthesis.Theme.Primary
    progressBar.BorderSizePixel = 0
    progressBar.Parent = progressBg
    Utils.ApplyCorner(progressBar, 2)
    
    -- æ·»åŠ åˆ°æ´»è·ƒåˆ—è¡¨
    local notifData = {
        Instance = notification,
        Height = NOTIF_HEIGHT
    }
    table.insert(self.ActiveNotifications, notifData)
    
    -- ==================== åŠ¨ç”» ====================
    
    -- å¼¹æ€§æ»‘å…¥
    Utils.Tween(notification, {
        Position = UDim2.new(0, 0, 1, -yOffset - NOTIF_HEIGHT),
        GroupTransparency = 0
    }, 0.5, Enum.EasingStyle.Back)
    
    -- è¿›åº¦æ¡åŠ¨ç”»
    Utils.Tween(progressBar, {
        Size = UDim2.new(0, 0, 1, 0)
    }, duration, Enum.EasingStyle.Linear)
    
    -- è‡ªåŠ¨æ¶ˆå¤±
    task.delay(duration, function()
        self:_DismissNotification(notifData)
    end)
    
    return notification
end

function NotificationSystem:_DismissNotification(notifData)
    if not notifData or not notifData.Instance then return end
    
    local notification = notifData.Instance
    
    -- ä»åˆ—è¡¨ç§»é™¤
    for i, n in ipairs(self.ActiveNotifications) do
        if n == notifData then
            table.remove(self.ActiveNotifications, i)
            break
        end
    end
    
    -- æ»‘å‡ºåŠ¨ç”»
    Utils.Tween(notification, {
        Position = notification.Position + UDim2.new(0, 80, 0, 0),
        GroupTransparency = 1
    }, 0.35, Enum.EasingStyle.Quart, Enum.EasingDirection.In)
    
    task.delay(0.35, function()
        if notification and notification.Parent then
            notification:Destroy()
        end
    end)
    
    -- æ›´æ–°å‰©ä½™é€šçŸ¥ä½ç½®
    task.delay(0.1, function()
        self:_UpdateStackPositions()
    end)
end

function NotificationSystem:_UpdateStackPositions()
    local currentY = SCREEN_MARGIN
    
    for i = #self.ActiveNotifications, 1, -1 do
        local notifData = self.ActiveNotifications[i]
        if notifData.Instance and notifData.Instance.Parent then
            local targetPos = UDim2.new(0, 0, 1, -currentY - notifData.Height)
            Utils.Tween(notifData.Instance, {Position = targetPos}, 0.3)
            currentY = currentY + notifData.Height + NOTIF_MARGIN
        end
    end
end

function NotificationSystem:SendWelcome(executorName)
    local player = LocalPlayer
    local username = player.DisplayName or player.Name
    
    -- è·å–å¤´åƒ
    local avatarUrl = ""
    Utils.SafeCall(function()
        avatarUrl = Players:GetUserThumbnailAsync(
            player.UserId,
            Enum.ThumbnailType.HeadShot,
            Enum.ThumbnailSize.Size100x100
        )
    end)
    
    self:Send(
        "Welcome Back, " .. username,
        "Injecting on " .. executorName .. "...",
        5,
        avatarUrl
    )
end

function NotificationSystem:ClearAll()
    for _, notifData in ipairs(self.ActiveNotifications) do
        if notifData.Instance and notifData.Instance.Parent then
            notifData.Instance:Destroy()
        end
    end
    self.ActiveNotifications = {}
end

function NotificationSystem:Destroy()
    self:ClearAll()
    if self.Container then
        self.Container:Destroy()
    end
end

Synthesis.NotificationSystem = NotificationSystem

-- â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
-- â•‘                    KEYBIND LIST                               â•‘
-- â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

local KeybindList = {
    Frame = nil,
    ListFrame = nil,
    Visible = true
}

function KeybindList:Init(parent)
    local scaleFactor = Platform.ScaleFactor
    
    self.Frame = Instance.new("CanvasGroup")
    self.Frame.Name = "KeybindList"
    self.Frame.Size = UDim2.new(0, 180 * scaleFactor, 0, 40 * scaleFactor)
    self.Frame.Position = UDim2.new(0, 20, 0.5, 0)
    self.Frame.AnchorPoint = Vector2.new(0, 0.5)
    self.Frame.BackgroundTransparency = 1
    self.Frame.Visible = false
    self.Frame.Parent = parent
    
    local bg = Instance.new("Frame")
    bg.Name = "Background"
    bg.Size = UDim2.new(1, 0, 1, 0)
    bg.BackgroundColor3 = Synthesis.Theme.Background
    bg.BackgroundTransparency = 0.15
    bg.Parent = self.Frame
    Utils.ApplyCorner(bg, 8)
    Utils.ApplyStroke(bg, Synthesis.Theme.Primary, 1, 0.7)
    
    local title = Instance.new("TextLabel")
    title.Name = "Title"
    title.Size = UDim2.new(1, -16, 0, 28 * scaleFactor)
    title.Position = UDim2.new(0, 8, 0, 5)
    title.BackgroundTransparency = 1
    title.Text = "âŒ¨ï¸ Active Keybinds"
    title.TextColor3 = Synthesis.Theme.TextPrimary
    title.Font = Enum.Font.GothamBold
    title.TextSize = 12 * scaleFactor
    title.TextXAlignment = Enum.TextXAlignment.Left
    title.Parent = self.Frame
    
    self.ListFrame = Instance.new("Frame")
    self.ListFrame.Name = "List"
    self.ListFrame.Size = UDim2.new(1, -16, 1, -38 * scaleFactor)
    self.ListFrame.Position = UDim2.new(0, 8, 0, 33 * scaleFactor)
    self.ListFrame.BackgroundTransparency = 1
    self.ListFrame.ClipsDescendants = true
    self.ListFrame.Parent = self.Frame
    
    local layout = Instance.new("UIListLayout")
    layout.SortOrder = Enum.SortOrder.Name
    layout.Padding = UDim.new(0, 3)
    layout.Parent = self.ListFrame
end

function KeybindList:Update(keybinds)
    if not self.ListFrame then return end
    
    -- æ¸…é™¤æ—§é¡¹ç›®
    for _, child in ipairs(self.ListFrame:GetChildren()) do
        if child:IsA("TextLabel") then
            child:Destroy()
        end
    end
    
    local count = 0
    local scaleFactor = Platform.ScaleFactor
    
    for flagName, data in pairs(keybinds) do
        if data.Enabled and data.Key then
            count = count + 1
            
            local item = Instance.new("TextLabel")
            item.Name = flagName
            item.Size = UDim2.new(1, 0, 0, 18 * scaleFactor)
            item.BackgroundTransparency = 1
            item.Text = string.format("[%s] %s", data.Key.Name, flagName)
            item.TextColor3 = data.Enabled and Synthesis.Theme.Success or Synthesis.Theme.TextMuted
            item.Font = Enum.Font.GothamMedium
            item.TextSize = 11 * scaleFactor
            item.TextXAlignment = Enum.TextXAlignment.Left
            item.Parent = self.ListFrame
        end
    end
    
    -- è°ƒæ•´é«˜åº¦
    local newHeight = 40 * scaleFactor + count * (21 * scaleFactor)
    self.Frame.Size = UDim2.new(0, 180 * scaleFactor, 0, newHeight)
    
    -- æ˜¾ç¤º/éšè—
    self.Frame.Visible = count > 0 and self.Visible
end

function KeybindList:Toggle(visible)
    if visible == nil then
        visible = not self.Frame.Visible
    end
    self.Visible = visible
    self.Frame.Visible = visible and #Synthesis.Keybinds > 0
end

function KeybindList:Destroy()
    if self.Frame then
        self.Frame:Destroy()
    end
end

Synthesis.KeybindList = KeybindList

-- â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
-- â•‘                  CONTEXT MENU (Right-Click)                   â•‘
-- â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

local ContextMenu = {}

function ContextMenu.Create(parent, options, position)
    local scaleFactor = Platform.ScaleFactor
    
    -- å…³é—­å·²å­˜åœ¨çš„èœå•
    local existing = parent:FindFirstChild("ContextMenu")
    if existing then
        existing:Destroy()
    end
    
    local menu = Instance.new("CanvasGroup")
    menu.Name = "ContextMenu"
    menu.Size = UDim2.new(0, 180 * scaleFactor, 0, 40 + #options * 35 * scaleFactor)
    menu.Position = position or UDim2.new(1, 10, 0, 0)
    menu.BackgroundTransparency = 1
    menu.GroupTransparency = 1
    menu.ZIndex = 500
    menu.Parent = parent
    
    Utils.ApplyShadow(menu)
    
    local bg = Instance.new("Frame")
    bg.Name = "Background"
    bg.Size = UDim2.new(1, 0, 1, 0)
    bg.BackgroundColor3 = Synthesis.Theme.Surface
    bg.Parent = menu
    Utils.ApplyCorner(bg, 10)
    Utils.ApplyStroke(bg, Synthesis.Theme.Primary, 1, 0.5)
    
    local title = Instance.new("TextLabel")
    title.Size = UDim2.new(1, 0, 0, 32 * scaleFactor)
    title.BackgroundTransparency = 1
    title.Text = "âš™ï¸ Settings"
    title.TextColor3 = Synthesis.Theme.TextPrimary
    title.Font = Enum.Font.GothamBold
    title.TextSize = 13 * scaleFactor
    title.Parent = bg
    
    -- åˆ†éš”çº¿
    local separator = Instance.new("Frame")
    separator.Size = UDim2.new(1, -20, 0, 1)
    separator.Position = UDim2.new(0.5, 0, 0, 32 * scaleFactor)
    separator.AnchorPoint = Vector2.new(0.5, 0)
    separator.BackgroundColor3 = Synthesis.Theme.SurfaceLight
    separator.BorderSizePixel = 0
    separator.Parent = bg
    
    -- åˆ›å»ºé€‰é¡¹
    for i, option in ipairs(options) do
        local btn = Instance.new("TextButton")
        btn.Name = option.Name
        btn.Size = UDim2.new(1, -16, 0, 32 * scaleFactor)
        btn.Position = UDim2.new(0, 8, 0, 36 * scaleFactor + (i-1) * 35 * scaleFactor)
        btn.BackgroundColor3 = Synthesis.Theme.SurfaceLight
        btn.BackgroundTransparency = 0.5
        btn.Text = (option.Icon or "") .. "  " .. option.Name
        btn.TextColor3 = Synthesis.Theme.TextSecondary
        btn.Font = Enum.Font.GothamMedium
        btn.TextSize = 12 * scaleFactor
        btn.TextXAlignment = Enum.TextXAlignment.Left
        btn.AutoButtonColor = false
        btn.Parent = bg
        Utils.ApplyCorner(btn, 6)
        
        local padding = Instance.new("UIPadding")
        padding.PaddingLeft = UDim.new(0, 10)
        padding.Parent = btn
        
        btn.MouseEnter:Connect(function()
            Utils.Tween(btn, {BackgroundTransparency = 0}, 0.15)
        end)
        
        btn.MouseLeave:Connect(function()
            Utils.Tween(btn, {BackgroundTransparency = 0.5}, 0.15)
        end)
        
        btn.MouseButton1Click:Connect(function()
            if option.Callback then
                option.Callback(btn)
            end
        end)
    end
    
    -- åŠ¨ç”»æ˜¾ç¤º
    Utils.Tween(menu, {GroupTransparency = 0}, 0.2, Enum.EasingStyle.Back)
    
    -- ç‚¹å‡»å¤–éƒ¨å…³é—­
    local closeConnection
    task.delay(0.1, function()
        closeConnection = UserInputService.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 or
               input.UserInputType == Enum.UserInputType.Touch then
                task.wait(0.05)
                
                -- æ£€æŸ¥ç‚¹å‡»æ˜¯å¦åœ¨èœå•å¤–
                local mousePos = UserInputService:GetMouseLocation()
                local menuPos = menu.AbsolutePosition
                local menuSize = menu.AbsoluteSize
                
                if mousePos.X < menuPos.X or mousePos.X > menuPos.X + menuSize.X or
                   mousePos.Y < menuPos.Y or mousePos.Y > menuPos.Y + menuSize.Y then
                    ContextMenu.Close(menu)
                    if closeConnection then
                        closeConnection:Disconnect()
                    end
                end
            end
        end)
    end)
    
    menu:SetAttribute("CloseConnection", closeConnection)
    
    return menu
end

function ContextMenu.Close(menu)
    if menu and menu.Parent then
        Utils.Tween(menu, {GroupTransparency = 1}, 0.2)
        task.delay(0.2, function()
            if menu and menu.Parent then
                menu:Destroy()
            end
        end)
    end
end

Synthesis.ContextMenu = ContextMenu

-- â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
-- â•‘                    LIBRARY INIT                               â•‘
-- â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function Synthesis:Init(config)
    config = config or {}
    
    if self._initialized then
        warn("[Synthesis] Already initialized!")
        return self
    end
    
    -- ==================== è·å–æ³¨å…¥å™¨åç§° ====================
    local executorName = "Unknown Executor"
    Utils.SafeCall(function()
        if identifyexecutor then
            executorName = identifyexecutor() or "Unknown"
        elseif getexecutorname then
            executorName = getexecutorname() or "Unknown"
        end
    end)
    self.ExecutorName = executorName
    
    -- ==================== åˆå§‹åŒ–é…ç½®ç®¡ç†å™¨ ====================
    ConfigManager:Init(config.ConfigName or tostring(game.PlaceId))
    
    -- ==================== åˆ›å»º ScreenGui ====================
    self.ScreenGui = Instance.new("ScreenGui")
    self.ScreenGui.Name = "SynthesisUI_" .. Utils.GenerateUID()
    self.ScreenGui.ResetOnSpawn = false
    self.ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    self.ScreenGui.IgnoreGuiInset = true
    self.ScreenGui.DisplayOrder = 999
    
    -- å°è¯•ä¿æŠ¤GUI
    local guiParent = nil
    Utils.SafeCall(function()
        if gethui then
            guiParent = gethui()
        elseif syn and syn.protect_gui then
            syn.protect_gui(self.ScreenGui)
            guiParent = CoreGui
        else
            guiParent = CoreGui
        end
    end)
    
    if not guiParent then
        guiParent = LocalPlayer:WaitForChild("PlayerGui")
    end
    
    self.ScreenGui.Parent = guiParent
    
    -- ==================== åˆå§‹åŒ–å­ç³»ç»Ÿ ====================
    NotificationSystem:Init(self.ScreenGui)
    
    if config.ShowKeybindList ~= false then
        KeybindList:Init(self.ScreenGui)
    end
    
    -- ==================== åŠ è½½å·²ä¿å­˜é…ç½® ====================
    local savedConfig = ConfigManager:Load()
    if savedConfig then
        self.Flags = savedConfig.Flags or {}
        self._savedPositions = savedConfig.WindowPositions or {}
        self.Keybinds = savedConfig.Keybinds or {}
        
        print("[Synthesis] Loaded saved configuration")
    end
    
    -- ==================== å‘é€æ¬¢è¿é€šçŸ¥ ====================
    if config.ShowWelcome ~= false then
        task.delay(0.5, function()
            NotificationSystem:SendWelcome(executorName)
            
            -- è®¾å¤‡ä¿¡æ¯é€šçŸ¥
            task.wait(0.4)
            local deviceIcon = Platform.IsMobile and "ğŸ“±" or "ğŸ–¥ï¸"
            local deviceTip = Platform.IsMobile 
                and "Long-press or swipe left for settings" 
                or "Right-click for settings"
            
            NotificationSystem:Send(
                deviceIcon .. " " .. Platform.DeviceName .. " Mode",
                deviceTip,
                4
            )
        end)
    end
    
    self._initialized = true
    self._unloaded = false
    
    -- ==================== æ§åˆ¶å°è¾“å‡º ====================
    print("â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—")
    print("â•‘     Synthesis: Cross-Platform UI Loaded!      â•‘")
    print("â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£")
    print("â•‘  Version:  " .. self.Version .. "                            â•‘")
    print("â•‘  Platform: " .. Platform.DeviceName .. string.rep(" ", 24 - #Platform.DeviceName) .. "          â•‘")
    print("â•‘  Executor: " .. string.sub(executorName, 1, 20) .. string.rep(" ", math.max(0, 24 - #executorName)) .. "    â•‘")
    print("â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
    
    return self
end

-- â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
-- â•‘                    CREATE WINDOW                              â•‘
-- â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function Synthesis:CreateWindow(options)
    options = options or {}
    
    local scaleFactor = Platform.ScaleFactor
    local baseWidth = (options.Width or 550) * scaleFactor
    local baseHeight = (options.Height or 400) * scaleFactor
    
    local window = {
        Name = options.Name or "Window",
        Title = options.Title or "Synthesis",
        Tabs = {},
        _connections = {},
        _visible = true
    }
    
    -- æ£€æŸ¥ä¿å­˜çš„ä½ç½®
    local savedPos = self._savedPositions and self._savedPositions[options.Name]
    local defaultPos = savedPos or UDim2.new(0.5, -baseWidth/2, 0.5, -baseHeight/2)
    
    -- ==================== ä¸»çª—å£ ====================
    
    window.Frame = Instance.new("CanvasGroup")
    window.Frame.Name = options.Name or "Window"
    window.Frame.Size = UDim2.new(0, baseWidth, 0, baseHeight)
    window.Frame.Position = defaultPos
    window.Frame.BackgroundTransparency = 1
    window.Frame.GroupTransparency = 1
    window.Frame.Parent = self.ScreenGui
    
    Utils.ApplyShadow(window.Frame)
    
    -- èƒŒæ™¯
    local background = Instance.new("Frame")
    background.Name = "Background"
    background.Size = UDim2.new(1, 0, 1, 0)
    background.BackgroundColor3 = self.Theme.Background
    background.Parent = window.Frame
    Utils.ApplyCorner(background, 12)
    Utils.ApplyStroke(background, self.Theme.Primary, 1.5, 0.5)
    
    -- ==================== æ ‡é¢˜æ  ====================
    
    local titleBar = Instance.new("Frame")
    titleBar.Name = "TitleBar"
    titleBar.Size = UDim2.new(1, 0, 0, 48 * scaleFactor)
    titleBar.BackgroundColor3 = self.Theme.Surface
    titleBar.BorderSizePixel = 0
    titleBar.Parent = background
    
    local titleCorner = Instance.new("UICorner")
    titleCorner.CornerRadius = UDim.new(0, 12)
    titleCorner.Parent = titleBar
    
    -- æ ‡é¢˜æ åº•éƒ¨é®æŒ¡åœ†è§’
    local titleFix = Instance.new("Frame")
    titleFix.Size = UDim2.new(1, 0, 0, 15)
    titleFix.Position = UDim2.new(0, 0, 1, -15)
    titleFix.BackgroundColor3 = self.Theme.Surface
    titleFix.BorderSizePixel = 0
    titleFix.Parent = titleBar
    
    -- Logo/Icon
    local logo = Instance.new("TextLabel")
    logo.Size = UDim2.new(0, 35 * scaleFactor, 0, 35 * scaleFactor)
    logo.Position = UDim2.new(0, 12, 0.5, 0)
    logo.AnchorPoint = Vector2.new(0, 0.5)
    logo.BackgroundColor3 = self.Theme.Primary
    logo.Text = "S"
    logo.TextColor3 = Color3.new(1, 1, 1)
    logo.Font = Enum.Font.GothamBlack
    logo.TextSize = 18 * scaleFactor
    logo.Parent = titleBar
    Utils.ApplyCorner(logo, 8)
    
    -- æ ‡é¢˜æ–‡å­—
    local titleText = Instance.new("TextLabel")
    titleText.Size = UDim2.new(1, -150 * scaleFactor, 1, 0)
    titleText.Position = UDim2.new(0, 55 * scaleFactor, 0, 0)
    titleText.BackgroundTransparency = 1
    titleText.Text = options.Title or "Synthesis"
    titleText.TextColor3 = self.Theme.TextPrimary
    titleText.Font = Enum.Font.GothamBold
    titleText.TextSize = 17 * scaleFactor
    titleText.TextXAlignment = Enum.TextXAlignment.Left
    titleText.Parent = titleBar
    
    -- å‰¯æ ‡é¢˜
    local subtitle = Instance.new("TextLabel")
    subtitle.Size = UDim2.new(0, 100, 0, 16)
    subtitle.Position = UDim2.new(0, 55 * scaleFactor, 0.5, 8)
    subtitle.BackgroundTransparency = 1
    subtitle.Text = "v" .. self.Version
    subtitle.TextColor3 = self.Theme.TextMuted
    subtitle.Font = Enum.Font.Gotham
    subtitle.TextSize = 11 * scaleFactor
    subtitle.TextXAlignment = Enum.TextXAlignment.Left
    subtitle.Parent = titleBar
    
    -- æœ€å°åŒ–æŒ‰é’®
    local minimizeBtn = Instance.new("ImageButton")
    minimizeBtn.Name = "MinimizeButton"
    minimizeBtn.Size = UDim2.new(0, 32 * scaleFactor, 0, 32 * scaleFactor)
    minimizeBtn.Position = UDim2.new(1, -85 * scaleFactor, 0.5, 0)
    minimizeBtn.AnchorPoint = Vector2.new(0, 0.5)
    minimizeBtn.BackgroundColor3 = self.Theme.SurfaceLight
    minimizeBtn.Image = self.Icons.Minimize
    minimizeBtn.ImageColor3 = self.Theme.TextSecondary
    minimizeBtn.Parent = titleBar
    Utils.ApplyCorner(minimizeBtn, 8)
    
    -- å…³é—­æŒ‰é’®
    local closeBtn = Instance.new("ImageButton")
    closeBtn.Name = "CloseButton"
    closeBtn.Size = UDim2.new(0, 32 * scaleFactor, 0, 32 * scaleFactor)
    closeBtn.Position = UDim2.new(1, -45 * scaleFactor, 0.5, 0)
    closeBtn.AnchorPoint = Vector2.new(0, 0.5)
    closeBtn.BackgroundColor3 = self.Theme.Error
    closeBtn.BackgroundTransparency = 0.5
    closeBtn.Image = self.Icons.Close
    closeBtn.ImageColor3 = self.Theme.TextPrimary
    closeBtn.Parent = titleBar
    Utils.ApplyCorner(closeBtn, 8)
    
    -- æŒ‰é’®äº‹ä»¶
    closeBtn.MouseButton1Click:Connect(function()
        window:Toggle(false)
    end)
    
    minimizeBtn.MouseButton1Click:Connect(function()
        window:Minimize()
    end)
    
    -- æŒ‰é’®æ‚¬åœæ•ˆæœ
    for _, btn in ipairs({closeBtn, minimizeBtn}) do
        btn.MouseEnter:Connect(function()
            Utils.Tween(btn, {BackgroundTransparency = 0}, 0.15)
        end)
        btn.MouseLeave:Connect(function()
            Utils.Tween(btn, {BackgroundTransparency = 0.5}, 0.15)
        end)
    end
    
    -- ==================== Tab å¯¼èˆªæ  ====================
    
    local tabNav = Instance.new("Frame")
    tabNav.Name = "TabNavigation"
    tabNav.Size = UDim2.new(0, 145 * scaleFactor, 1, -58 * scaleFactor)
    tabNav.Position = UDim2.new(0, 10, 0, 53 * scaleFactor)
    tabNav.BackgroundColor3 = self.Theme.Surface
    tabNav.BackgroundTransparency = 0.3
    tabNav.Parent = background
    Utils.ApplyCorner(tabNav, 10)
    
    local tabLayout = Instance.new("UIListLayout")
    tabLayout.SortOrder = Enum.SortOrder.LayoutOrder
    tabLayout.Padding = UDim.new(0, 5)
    tabLayout.Parent = tabNav
    
    local tabPadding = Instance.new("UIPadding")
    tabPadding.PaddingTop = UDim.new(0, 10)
    tabPadding.PaddingLeft = UDim.new(0, 8)
    tabPadding.PaddingRight = UDim.new(0, 8)
    tabPadding.PaddingBottom = UDim.new(0, 10)
    tabPadding.Parent = tabNav
    
    -- ==================== å†…å®¹åŒºåŸŸ ====================
    
    local contentArea = Instance.new("ScrollingFrame")
    contentArea.Name = "ContentArea"
    contentArea.Size = UDim2.new(1, -175 * scaleFactor, 1, -63 * scaleFactor)
    contentArea.Position = UDim2.new(0, 165 * scaleFactor, 0, 53 * scaleFactor)
    contentArea.BackgroundTransparency = 1
    contentArea.ScrollBarThickness = 4
    contentArea.ScrollBarImageColor3 = self.Theme.Primary
    contentArea.ScrollBarImageTransparency = 0.3
    contentArea.CanvasSize = UDim2.new(0, 0, 0, 0)
    contentArea.AutomaticCanvasSize = Enum.AutomaticSize.Y
    contentArea.Parent = background
    
    local contentLayout = Instance.new("UIListLayout")
    contentLayout.SortOrder = Enum.SortOrder.LayoutOrder
    contentLayout.Padding = UDim.new(0, 8)
    contentLayout.Parent = contentArea
    
    local contentPadding = Instance.new("UIPadding")
    contentPadding.PaddingTop = UDim.new(0, 5)
    contentPadding.PaddingLeft = UDim.new(0, 10)
    contentPadding.PaddingRight = UDim.new(0, 15)
    contentPadding.PaddingBottom = UDim.new(0, 15)
    contentPadding.Parent = contentArea
    
    -- ==================== æ‹–æ‹½åŠŸèƒ½ ====================
    
    local dragConnections = InputHandler.BindDrag(titleBar, window.Frame, function(newPos)
        -- ä¿å­˜ä½ç½®
        Synthesis._savedPositions[options.Name] = newPos
        ConfigManager:Save({
            Flags = Synthesis.Flags,
            WindowPositions = Synthesis._savedPositions,
            Keybinds = Synthesis.Keybinds
        })
    end)
    
    for name, conn in pairs(dragConnections) do
        window._connections["Drag_" .. name] = conn
    end
    
    -- ==================== çª—å£æ–¹æ³• ====================
    
    function window:Toggle(visible)
        if visible == nil then
            visible = not self._visible
        end
        self._visible = visible
        
        Utils.Tween(self.Frame, {
            GroupTransparency = visible and 0 or 1
        }, 0.35, visible and Enum.EasingStyle.Back or Enum.EasingStyle.Quart)
        
        if not visible then
            task.delay(0.35, function()
                if self.Frame.GroupTransparency > 0.9 then
                    -- å¯é€‰: å®Œå…¨éšè—ä»¥èŠ‚çœæ€§èƒ½
                end
            end)
        end
    end
    
    function window:Minimize()
        -- æœ€å°åŒ–åˆ°åªæ˜¾ç¤ºæ ‡é¢˜æ 
        local minimized = background.Size.Y.Offset < 100
        
        Utils.Tween(background, {
            Size = minimized and UDim2.new(1, 0, 1, 0) or UDim2.new(1, 0, 0, 48 * scaleFactor)
        }, 0.3)
        
        contentArea.Visible = minimized
        tabNav.Visible = minimized
    end
    
    function window:Destroy()
        for _, conn in pairs(self._connections) do
            if conn and typeof(conn) == "RBXScriptConnection" then
                conn:Disconnect()
            end
        end
        
        for _, tab in ipairs(self.Tabs) do
            for _, conn in pairs(tab._connections or {}) do
                if conn and typeof(conn) == "RBXScriptConnection" then
                    conn:Disconnect()
                end
            end
        end
        
        if self.Frame then
            self.Frame:Destroy()
        end
    end
    
    -- ==================== åˆ›å»º Tab ====================
    
    function window:CreateTab(tabOptions)
        tabOptions = tabOptions or {}
        
        local tab = {
            Name = tabOptions.Name or "Tab",
            Icon = tabOptions.Icon or "ğŸ“",
            Elements = {},
            _connections = {},
            _visible = #window.Tabs == 0  -- ç¬¬ä¸€ä¸ªTabé»˜è®¤æ˜¾ç¤º
        }
        
        local tabIndex = #window.Tabs + 1
        
        -- Tab æŒ‰é’®
        local tabButton = Instance.new("TextButton")
        tabButton.Name = tabOptions.Name
        tabButton.Size = UDim2.new(1, 0, 0, 38 * scaleFactor)
        tabButton.BackgroundColor3 = Synthesis.Theme.SurfaceLight
        tabButton.BackgroundTransparency = tab._visible and 0 or 0.7
        tabButton.Text = ""
        tabButton.AutoButtonColor = false
        tabButton.Parent = tabNav
        Utils.ApplyCorner(tabButton, 8)
        
        -- Tab å›¾æ ‡å’Œæ–‡å­—
        local tabIcon = Instance.new("TextLabel")
        tabIcon.Size = UDim2.new(0, 25, 1, 0)
        tabIcon.Position = UDim2.new(0, 10, 0, 0)
        tabIcon.BackgroundTransparency = 1
        tabIcon.Text = tabOptions.Icon or "ğŸ“"
        tabIcon.TextSize = 14 * scaleFactor
        tabIcon.Parent = tabButton
        
        local tabLabel = Instance.new("TextLabel")
        tabLabel.Size = UDim2.new(1, -45, 1, 0)
        tabLabel.Position = UDim2.new(0, 35, 0, 0)
        tabLabel.BackgroundTransparency = 1
        tabLabel.Text = tabOptions.Name
        tabLabel.TextColor3 = Synthesis.Theme.TextPrimary
        tabLabel.Font = Enum.Font.GothamMedium
        tabLabel.TextSize = 13 * scaleFactor
        tabLabel.TextXAlignment = Enum.TextXAlignment.Left
        tabLabel.TextTruncate = Enum.TextTruncate.AtEnd
        tabLabel.Parent = tabButton
        
        -- é€‰ä¸­æŒ‡ç¤ºå™¨
        local indicator = Instance.new("Frame")
        indicator.Name = "Indicator"
        indicator.Size = UDim2.new(0, 3, 0.6, 0)
        indicator.Position = UDim2.new(0, 0, 0.5, 0)
        indicator.AnchorPoint = Vector2.new(0, 0.5)
        indicator.BackgroundColor3 = Synthesis.Theme.Primary
        indicator.Visible = tab._visible
        indicator.Parent = tabButton
        Utils.ApplyCorner(indicator, 2)
        
        -- Tab å†…å®¹å®¹å™¨
        local tabContent = Instance.new("Frame")
        tabContent.Name = tabOptions.Name .. "_Content"
        tabContent.Size = UDim2.new(1, 0, 0, 0)
        tabContent.BackgroundTransparency = 1
        tabContent.Visible = tab._visible
        tabContent.AutomaticSize = Enum.AutomaticSize.Y
        tabContent.LayoutOrder = tabIndex
        tabContent.Parent = contentArea
        
        local contentLayout = Instance.new("UIListLayout")
        contentLayout.SortOrder = Enum.SortOrder.LayoutOrder
        contentLayout.Padding = UDim.new(0, 8)
        contentLayout.Parent = tabContent
        
        tab.Button = tabButton
        tab.Content = tabContent
        tab.Indicator = indicator
        
        -- Tab åˆ‡æ¢é€»è¾‘
        tabButton.MouseButton1Click:Connect(function()
            for _, t in ipairs(window.Tabs) do
                t._visible = false
                t.Content.Visible = false
                t.Indicator.Visible = false
                Utils.Tween(t.Button, {BackgroundTransparency = 0.7}, 0.2)
            end
            
            tab._visible = true
            tab.Content.Visible = true
            tab.Indicator.Visible = true
            Utils.Tween(tabButton, {BackgroundTransparency = 0}, 0.2)
        end)
        
        -- æ‚¬åœæ•ˆæœ
        tabButton.MouseEnter:Connect(function()
            if not tab._visible then
                Utils.Tween(tabButton, {BackgroundTransparency = 0.4}, 0.15)
            end
        end)
        
        tabButton.MouseLeave:Connect(function()
            if not tab._visible then
                Utils.Tween(tabButton, {BackgroundTransparency = 0.7}, 0.15)
            end
        end)
        
        -- ==================== åˆ›å»º Toggle ====================
        
        function tab:CreateToggle(toggleOptions)
            toggleOptions = toggleOptions or {}
            
            local toggle = {
                Name = toggleOptions.Name or "Toggle",
                Value = toggleOptions.Default or false,
                Callback = toggleOptions.Callback,
                Flag = toggleOptions.Flag,
                _keybind = nil
            }
            
            -- æ£€æŸ¥å·²ä¿å­˜çš„çŠ¶æ€
            if toggleOptions.Flag and Synthesis.Flags[toggleOptions.Flag] ~= nil then
                toggle.Value = Synthesis.Flags[toggleOptions.Flag]
            end
            
            -- å­˜å‚¨åˆ° Flags
            if toggleOptions.Flag then
                Synthesis.Flags[toggleOptions.Flag] = toggle.Value
            end
            
            -- UI
            local toggleFrame = Instance.new("Frame")
            toggleFrame.Name = toggleOptions.Name
            toggleFrame.Size = UDim2.new(1, 0, 0, 48 * scaleFactor)
            toggleFrame.BackgroundColor3 = Synthesis.Theme.Surface
            toggleFrame.LayoutOrder = #tab.Elements + 1
            toggleFrame.Parent = tabContent
            Utils.ApplyCorner(toggleFrame, 8)
            
            local toggleBg = Instance.new("Frame")
            toggleBg.Name = "Background"
            toggleBg.Size = UDim2.new(1, 0, 1, 0)
            toggleBg.BackgroundColor3 = Synthesis.Theme.Surface
            toggleBg.BackgroundTransparency = 0
            toggleBg.Parent = toggleFrame
            Utils.ApplyCorner(toggleBg, 8)
            
            local toggleLabel = Instance.new("TextLabel")
            toggleLabel.Size = UDim2.new(1, -80 * scaleFactor, 1, 0)
            toggleLabel.Position = UDim2.new(0, 15, 0, 0)
            toggleLabel.BackgroundTransparency = 1
            toggleLabel.Text = toggleOptions.Name
            toggleLabel.TextColor3 = Synthesis.Theme.TextPrimary
            toggleLabel.Font = Enum.Font.GothamMedium
            toggleLabel.TextSize = 14 * scaleFactor
            toggleLabel.TextXAlignment = Enum.TextXAlignment.Left
            toggleLabel.Parent = toggleFrame
            
            -- æè¿°æ–‡å­— (å¦‚æœæœ‰)
            if toggleOptions.Description then
                toggleLabel.Size = UDim2.new(1, -80 * scaleFactor, 0, 22)
                toggleLabel.Position = UDim2.new(0, 15, 0, 8)
                
                local descLabel = Instance.new("TextLabel")
                descLabel.Size = UDim2.new(1, -80 * scaleFactor, 0, 16)
                descLabel.Position = UDim2.new(0, 15, 0, 28)
                descLabel.BackgroundTransparency = 1
                descLabel.Text = toggleOptions.Description
                descLabel.TextColor3 = Synthesis.Theme.TextMuted
                descLabel.Font = Enum.Font.Gotham
                descLabel.TextSize = 11 * scaleFactor
                descLabel.TextXAlignment = Enum.TextXAlignment.Left
                descLabel.TextTruncate = Enum.TextTruncate.AtEnd
                descLabel.Parent = toggleFrame
            end
            
            -- Toggle å¼€å…³
            local switchWidth = 46 * scaleFactor
            local switchHeight = 26 * scaleFactor
            local circleSize = 20 * scaleFactor
            
            local toggleSwitch = Instance.new("Frame")
            toggleSwitch.Name = "Switch"
            toggleSwitch.Size = UDim2.new(0, switchWidth, 0, switchHeight)
            toggleSwitch.Position = UDim2.new(1, -switchWidth - 12, 0.5, 0)
            toggleSwitch.AnchorPoint = Vector2.new(0, 0.5)
            toggleSwitch.BackgroundColor3 = toggle.Value and Synthesis.Theme.Primary or Color3.fromRGB(60, 60, 75)
            toggleSwitch.Parent = toggleFrame
            Utils.ApplyCorner(toggleSwitch, 13)
            
            local toggleCircle = Instance.new("Frame")
            toggleCircle.Name = "Circle"
            toggleCircle.Size = UDim2.new(0, circleSize, 0, circleSize)
            toggleCircle.Position = UDim2.new(0, toggle.Value and (switchWidth - circleSize - 3) or 3, 0.5, 0)
            toggleCircle.AnchorPoint = Vector2.new(0, 0.5)
            toggleCircle.BackgroundColor3 = Color3.new(1, 1, 1)
            toggleCircle.Parent = toggleSwitch
            Utils.ApplyCorner(toggleCircle, 10)
            
            -- æ›´æ–°å‡½æ•°
            local function updateToggle(value, skipCallback)
                toggle.Value = value
                
                if toggleOptions.Flag then
                    Synthesis.Flags[toggleOptions.Flag] = value
                end
                
                -- æ›´æ–°Keybindåˆ—è¡¨
                if toggle._keybind then
                    Synthesis.Keybinds[toggleOptions.Name] = {
                        Key = toggle._keybind,
                        Enabled = value
                    }
                    KeybindList:Update(Synthesis.Keybinds)
                end
                
                -- åŠ¨ç”»
                Utils.Tween(toggleSwitch, {
                    BackgroundColor3 = value and Synthesis.Theme.Primary or Color3.fromRGB(60, 60, 75)
                }, 0.2)
                
                Utils.Tween(toggleCircle, {
                    Position = UDim2.new(0, value and (switchWidth - circleSize - 3) or 3, 0.5, 0)
                }, 0.2, Enum.EasingStyle.Back)
                
                -- å›è°ƒ
                if not skipCallback and toggle.Callback then
                    toggle.Callback(value)
                end
                
                -- ä¿å­˜é…ç½®
                ConfigManager:Save({
                    Flags = Synthesis.Flags,
                    WindowPositions = Synthesis._savedPositions or {},
                    Keybinds = Synthesis.Keybinds
                })
            end
            
            -- å³é”®èœå•
            local function showContextMenu()
                local menuOptions = {
                    {
                        Name = "Set Keybind",
                        Icon = "ğŸ”‘",
                        Callback = function(btn)
                            btn.Text = "ğŸ”‘  Press any key..."
                            
                            local bindConn
                            bindConn = UserInputService.InputBegan:Connect(function(input)
                                if input.UserInputType == Enum.UserInputType.Keyboard then
                                    toggle._keybind = input.KeyCode
                                    btn.Text = "ğŸ”‘  Bound: [" .. input.KeyCode.Name .. "]"
                                    
                                    Synthesis.Keybinds[toggleOptions.Name] = {
                                        Key = input.KeyCode,
                                        Enabled = toggle.Value
                                    }
                                    KeybindList:Update(Synthesis.Keybinds)
                                    
                                    -- ä¿å­˜
                                    ConfigManager:Save({
                                        Flags = Synthesis.Flags,
                                        WindowPositions = Synthesis._savedPositions,
                                        Keybinds = Synthesis.Keybinds
                                    })
                                    
                                    bindConn:Disconnect()
                                    
                                    Synthesis:Notify("âœ… Keybind Set", 
                                        toggleOptions.Name .. " bound to [" .. input.KeyCode.Name .. "]", 3)
                                end
                            end)
                        end
                    },
                    {
                        Name = "Clear Keybind",
                        Icon = "ğŸ—‘ï¸",
                        Callback = function()
                            toggle._keybind = nil
                            Synthesis.Keybinds[toggleOptions.Name] = nil
                            KeybindList:Update(Synthesis.Keybinds)
                            
                            -- å…³é—­èœå•
                            local menu = toggleFrame:FindFirstChild("ContextMenu")
                            if menu then ContextMenu.Close(menu) end
                            
                            Synthesis:Notify("ğŸ—‘ï¸ Cleared", "Keybind removed for " .. toggleOptions.Name, 2)
                        end
                    }
                }
                
                ContextMenu.Create(toggleFrame, menuOptions)
            end
            
            -- ç»‘å®šäº¤äº’
            local connections = InputHandler.BindButton(
                toggleFrame,
                function() updateToggle(not toggle.Value) end,
                showContextMenu
            )
            
            for name, conn in pairs(connections) do
                tab._connections[toggleOptions.Name .. "_" .. name] = conn
            end
            
            -- æŒ‰é”®ç›‘å¬
            tab._connections[toggleOptions.Name .. "_Keybind"] = UserInputService.InputBegan:Connect(function(input, gameProcessed)
                if gameProcessed then return end
                
                if input.UserInputType == Enum.UserInputType.Keyboard and toggle._keybind then
                    if input.KeyCode == toggle._keybind then
                        updateToggle(not toggle.Value)
                    end
                end
            end)
            
            -- API
            function toggle:Set(value)
                updateToggle(value)
            end
            
            function toggle:Get()
                return toggle.Value
            end
            
            -- åˆå§‹å›è°ƒ (å¦‚æœå·²æœ‰ä¿å­˜å€¼)
            if toggle.Value and toggle.Callback then
                task.spawn(function()
                    toggle.Callback(toggle.Value)
                end)
            end
            
            table.insert(tab.Elements, toggle)
            return toggle
        end
        
        -- ==================== åˆ›å»º Slider ====================
        
        function tab:CreateSlider(sliderOptions)
            sliderOptions = sliderOptions or {}
            
            local slider = {
                Name = sliderOptions.Name or "Slider",
                Value = sliderOptions.Default or sliderOptions.Min or 0,
                Min = sliderOptions.Min or 0,
                Max = sliderOptions.Max or 100,
                Increment = sliderOptions.Increment or 1,
                Callback = sliderOptions.Callback,
                Flag = sliderOptions.Flag
            }
            
            -- æ£€æŸ¥å·²ä¿å­˜å€¼
            if sliderOptions.Flag and Synthesis.Flags[sliderOptions.Flag] ~= nil then
                slider.Value = Synthesis.Flags[sliderOptions.Flag]
            end
            
            if sliderOptions.Flag then
                Synthesis.Flags[sliderOptions.Flag] = slider.Value
            end
            
            -- UI
            local sliderFrame = Instance.new("Frame")
            sliderFrame.Name = sliderOptions.Name
            sliderFrame.Size = UDim2.new(1, 0, 0, 60 * scaleFactor)
            sliderFrame.BackgroundColor3 = Synthesis.Theme.Surface
            sliderFrame.LayoutOrder = #tab.Elements + 1
            sliderFrame.Parent = tabContent
            Utils.ApplyCorner(sliderFrame, 8)
            
            local sliderLabel = Instance.new("TextLabel")
            sliderLabel.Size = UDim2.new(1, -80, 0, 25)
            sliderLabel.Position = UDim2.new(0, 15, 0, 8)
            sliderLabel.BackgroundTransparency = 1
            sliderLabel.Text = sliderOptions.Name
            sliderLabel.TextColor3 = Synthesis.Theme.TextPrimary
            sliderLabel.Font = Enum.Font.GothamMedium
            sliderLabel.TextSize = 14 * scaleFactor
            sliderLabel.TextXAlignment = Enum.TextXAlignment.Left
            sliderLabel.Parent = sliderFrame
            
            local valueLabel = Instance.new("TextLabel")
            valueLabel.Size = UDim2.new(0, 60, 0, 25)
            valueLabel.Position = UDim2.new(1, -70, 0, 8)
            valueLabel.BackgroundTransparency = 1
            valueLabel.Text = tostring(slider.Value)
            valueLabel.TextColor3 = Synthesis.Theme.Primary
            valueLabel.Font = Enum.Font.GothamBold
            valueLabel.TextSize = 14 * scaleFactor
            valueLabel.TextXAlignment = Enum.TextXAlignment.Right
            valueLabel.Parent = sliderFrame
            
            local sliderTrack = Instance.new("Frame")
            sliderTrack.Name = "Track"
            sliderTrack.Size = UDim2.new(1, -30, 0, 8)
            sliderTrack.Position = UDim2.new(0, 15, 0, 40 * scaleFactor)
            sliderTrack.BackgroundColor3 = Synthesis.Theme.SurfaceLight
            sliderTrack.Parent = sliderFrame
            Utils.ApplyCorner(sliderTrack, 4)
            
            local percent = (slider.Value - slider.Min) / (slider.Max - slider.Min)
            
            local sliderFill = Instance.new("Frame")
            sliderFill.Name = "Fill"
            sliderFill.Size = UDim2.new(percent, 0, 1, 0)
            sliderFill.BackgroundColor3 = Synthesis.Theme.Primary
            sliderFill.Parent = sliderTrack
            Utils.ApplyCorner(sliderFill, 4)
            
            -- æ»‘å—åœ†ç‚¹
            local sliderKnob = Instance.new("Frame")
            sliderKnob.Name = "Knob"
            sliderKnob.Size = UDim2.new(0, 16 * scaleFactor, 0, 16 * scaleFactor)
            sliderKnob.Position = UDim2.new(percent, 0, 0.5, 0)
            sliderKnob.AnchorPoint = Vector2.new(0.5, 0.5)
            sliderKnob.BackgroundColor3 = Color3.new(1, 1, 1)
            sliderKnob.Parent = sliderTrack
            Utils.ApplyCorner(sliderKnob, 8)
            Utils.ApplyStroke(sliderKnob, Synthesis.Theme.Primary, 2, 0)
            
            -- æ›´æ–°å‡½æ•°
            local function updateSlider(value, skipCallback)
                value = math.clamp(value, slider.Min, slider.Max)
                
                -- åº”ç”¨å¢é‡
                if slider.Increment then
                    value = math.floor(value / slider.Increment + 0.5) * slider.Increment
                end
                
                slider.Value = value
                
                if sliderOptions.Flag then
                    Synthesis.Flags[sliderOptions.Flag] = value
                end
                
                local newPercent = (value - slider.Min) / (slider.Max - slider.Min)
                
                Utils.Tween(sliderFill, {Size = UDim2.new(newPercent, 0, 1, 0)}, 0.1)
                Utils.Tween(sliderKnob, {Position = UDim2.new(newPercent, 0, 0.5, 0)}, 0.1)
                
                valueLabel.Text = tostring(math.floor(value * 100) / 100)  -- ä¿ç•™2ä½å°æ•°
                
                if not skipCallback and slider.Callback then
                    slider.Callback(value)
                end
                
                -- ä¿å­˜
                ConfigManager:Save({
                    Flags = Synthesis.Flags,
                    WindowPositions = Synthesis._savedPositions,
                    Keybinds = Synthesis.Keybinds
                })
            end
            
            -- æ‹–æ‹½é€»è¾‘
            local dragging = false
            
            local function calculateValue(inputPos)
                local trackPos = sliderTrack.AbsolutePosition.X
                local trackSize = sliderTrack.AbsoluteSize.X
                local relativeX = math.clamp((inputPos.X - trackPos) / trackSize, 0, 1)
                return slider.Min + (slider.Max - slider.Min) * relativeX
            end
            
            sliderTrack.InputBegan:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 or
                   input.UserInputType == Enum.UserInputType.Touch then
                    dragging = true
                    updateSlider(calculateValue(input.Position))
                end
            end)
            
            tab._connections[sliderOptions.Name .. "_Move"] = UserInputService.InputChanged:Connect(function(input)
                if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or
                                 input.UserInputType == Enum.UserInputType.Touch) then
                    updateSlider(calculateValue(input.Position))
                end
            end)
            
            tab._connections[sliderOptions.Name .. "_End"] = UserInputService.InputEnded:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 or
                   input.UserInputType == Enum.UserInputType.Touch then
                    dragging = false
                end
            end)
            
            -- API
            function slider:Set(value)
                updateSlider(value)
            end
            
            function slider:Get()
                return slider.Value
            end
            
            -- åˆå§‹å›è°ƒ
            if slider.Callback then
                task.spawn(function()
                    slider.Callback(slider.Value)
                end)
            end
            
            table.insert(tab.Elements, slider)
            return slider
        end
        
        -- ==================== åˆ›å»º Button ====================
        
        function tab:CreateButton(buttonOptions)
            buttonOptions = buttonOptions or {}
            
            local button = {
                Name = buttonOptions.Name or "Button",
                Callback = buttonOptions.Callback
            }
            
            local buttonFrame = Instance.new("TextButton")
            buttonFrame.Name = buttonOptions.Name
            buttonFrame.Size = UDim2.new(1, 0, 0, 42 * scaleFactor)
            buttonFrame.BackgroundColor3 = buttonOptions.Primary and Synthesis.Theme.Primary or Synthesis.Theme.Surface
            buttonFrame.Text = ""
            buttonFrame.AutoButtonColor = false
            buttonFrame.LayoutOrder = #tab.Elements + 1
            buttonFrame.Parent = tabContent
            Utils.ApplyCorner(buttonFrame, 8)
            
            if buttonOptions.Primary then
                Utils.ApplyGradient(buttonFrame, Synthesis.Theme.Primary, Synthesis.Theme.PrimaryDark)
            end
            
            local buttonLabel = Instance.new("TextLabel")
            buttonLabel.Size = UDim2.new(1, 0, 1, 0)
            buttonLabel.BackgroundTransparency = 1
            buttonLabel.Text = (buttonOptions.Icon or "") .. "  " .. buttonOptions.Name
            buttonLabel.TextColor3 = Synthesis.Theme.TextPrimary
            buttonLabel.Font = Enum.Font.GothamBold
            buttonLabel.TextSize = 14 * scaleFactor
            buttonLabel.Parent = buttonFrame
            
            buttonFrame.MouseButton1Click:Connect(function()
                -- ç‚¹å‡»åŠ¨ç”»
                Utils.Tween(buttonFrame, {
                    BackgroundColor3 = buttonOptions.Primary and Synthesis.Theme.PrimaryDark or Synthesis.Theme.SurfaceLight
                }, 0.1)
                
                task.wait(0.1)
                
                Utils.Tween(buttonFrame, {
                    BackgroundColor3 = buttonOptions.Primary and Synthesis.Theme.Primary or Synthesis.Theme.Surface
                }, 0.1)
                
                if button.Callback then
                    button.Callback()
                end
            end)
            
            -- æ‚¬åœæ•ˆæœ
            buttonFrame.MouseEnter:Connect(function()
                Utils.Tween(buttonFrame, {
                    BackgroundColor3 = buttonOptions.Primary and Synthesis.Theme.Accent or Synthesis.Theme.SurfaceLight
                }, 0.15)
            end)
            
            buttonFrame.MouseLeave:Connect(function()
                Utils.Tween(buttonFrame, {
                    BackgroundColor3 = buttonOptions.Primary and Synthesis.Theme.Primary or Synthesis.Theme.Surface
                }, 0.15)
            end)
            
            table.insert(tab.Elements, button)
            return button
        end
        
        -- ==================== åˆ›å»º Dropdown ====================
        
        function tab:CreateDropdown(dropdownOptions)
            dropdownOptions = dropdownOptions or {}
            
            local dropdown = {
                Name = dropdownOptions.Name or "Dropdown",
                Options = dropdownOptions.Options or {},
                Value = dropdownOptions.Default or (dropdownOptions.Options and dropdownOptions.Options[1]) or "",
                Callback = dropdownOptions.Callback,
                Flag = dropdownOptions.Flag,
                _open = false
            }
            
            if dropdownOptions.Flag then
                Synthesis.Flags[dropdownOptions.Flag] = dropdown.Value
            end
            
            local dropdownFrame = Instance.new("Frame")
            dropdownFrame.Name = dropdownOptions.Name
            dropdownFrame.Size = UDim2.new(1, 0, 0, 48 * scaleFactor)
            dropdownFrame.BackgroundColor3 = Synthesis.Theme.Surface
            dropdownFrame.ClipsDescendants = true
            dropdownFrame.LayoutOrder = #tab.Elements + 1
            dropdownFrame.Parent = tabContent
            Utils.ApplyCorner(dropdownFrame, 8)
            
            local dropdownLabel = Instance.new("TextLabel")
            dropdownLabel.Size = UDim2.new(0.5, -10, 0, 48 * scaleFactor)
            dropdownLabel.Position = UDim2.new(0, 15, 0, 0)
            dropdownLabel.BackgroundTransparency = 1
            dropdownLabel.Text = dropdownOptions.Name
            dropdownLabel.TextColor3 = Synthesis.Theme.TextPrimary
            dropdownLabel.Font = Enum.Font.GothamMedium
            dropdownLabel.TextSize = 14 * scaleFactor
            dropdownLabel.TextXAlignment = Enum.TextXAlignment.Left
            dropdownLabel.Parent = dropdownFrame
            
            local selectedBtn = Instance.new("TextButton")
            selectedBtn.Size = UDim2.new(0.5, -20, 0, 32 * scaleFactor)
            selectedBtn.Position = UDim2.new(0.5, 5, 0, 8)
            selectedBtn.BackgroundColor3 = Synthesis.Theme.SurfaceLight
            selectedBtn.Text = dropdown.Value
            selectedBtn.TextColor3 = Synthesis.Theme.TextSecondary
            selectedBtn.Font = Enum.Font.GothamMedium
            selectedBtn.TextSize = 13 * scaleFactor
            selectedBtn.AutoButtonColor = false
            selectedBtn.Parent = dropdownFrame
            Utils.ApplyCorner(selectedBtn, 6)
            
            -- ç®­å¤´å›¾æ ‡
            local arrow = Instance.new("ImageLabel")
            arrow.Size = UDim2.new(0, 16, 0, 16)
            arrow.Position = UDim2.new(1, -25, 0.5, 0)
            arrow.AnchorPoint = Vector2.new(0, 0.5)
            arrow.BackgroundTransparency = 1
            arrow.Image = Synthesis.Icons.ChevronDown
            arrow.ImageColor3 = Synthesis.Theme.TextMuted
            arrow.Parent = selectedBtn
            
            -- é€‰é¡¹å®¹å™¨
            local optionsFrame = Instance.new("Frame")
            optionsFrame.Name = "Options"
            optionsFrame.Size = UDim2.new(1, -30, 0, #dropdown.Options * 32 * scaleFactor)
            optionsFrame.Position = UDim2.new(0, 15, 0, 52 * scaleFactor)
            optionsFrame.BackgroundTransparency = 1
            optionsFrame.Visible = false
            optionsFrame.Parent = dropdownFrame
            
            local optionsLayout = Instance.new("UIListLayout")
            optionsLayout.Padding = UDim.new(0, 4)
            optionsLayout.Parent = optionsFrame
            
            -- åˆ›å»ºé€‰é¡¹æŒ‰é’®
            for i, option in ipairs(dropdown.Options) do
                local optBtn = Instance.new("TextButton")
                optBtn.Size = UDim2.new(1, 0, 0, 28 * scaleFactor)
                optBtn.BackgroundColor3 = Synthesis.Theme.SurfaceLight
                optBtn.BackgroundTransparency = 0.5
                optBtn.Text = option
                optBtn.TextColor3 = Synthesis.Theme.TextSecondary
                optBtn.Font = Enum.Font.Gotham
                optBtn.TextSize = 12 * scaleFactor
                optBtn.AutoButtonColor = false
                optBtn.Parent = optionsFrame
                Utils.ApplyCorner(optBtn, 4)
                
                optBtn.MouseButton1Click:Connect(function()
                    dropdown.Value = option
                    selectedBtn.Text = option
                    
                    if dropdownOptions.Flag then
                        Synthesis.Flags[dropdownOptions.Flag] = option
                    end
                    
                    if dropdown.Callback then
                        dropdown.Callback(option)
                    end
                    
                    -- å…³é—­ä¸‹æ‹‰
                    dropdown._open = false
                    optionsFrame.Visible = false
                    Utils.Tween(dropdownFrame, {
                        Size = UDim2.new(1, 0, 0, 48 * scaleFactor)
                    }, 0.2)
                    Utils.Tween(arrow, {Rotation = 0}, 0.2)
                end)
                
                optBtn.MouseEnter:Connect(function()
                    Utils.Tween(optBtn, {BackgroundTransparency = 0}, 0.1)
                end)
                
                optBtn.MouseLeave:Connect(function()
                    Utils.Tween(optBtn, {BackgroundTransparency = 0.5}, 0.1)
                end)
            end
            
            -- åˆ‡æ¢ä¸‹æ‹‰
            selectedBtn.MouseButton1Click:Connect(function()
                dropdown._open = not dropdown._open
                optionsFrame.Visible = dropdown._open
                
                local targetHeight = dropdown._open 
                    and (52 * scaleFactor + #dropdown.Options * 32 * scaleFactor + 10)
                    or (48 * scaleFactor)
                
                Utils.Tween(dropdownFrame, {Size = UDim2.new(1, 0, 0, targetHeight)}, 0.25)
                Utils.Tween(arrow, {Rotation = dropdown._open and 180 or 0}, 0.25)
            end)
            
            function dropdown:Set(value)
                if table.find(dropdown.Options, value) then
                    dropdown.Value = value
                    selectedBtn.Text = value
                    
                    if dropdown.Callback then
                        dropdown.Callback(value)
                    end
                end
            end
            
            table.insert(tab.Elements, dropdown)
            return dropdown
        end
        
        -- ==================== åˆ›å»º TextBox ====================
        
        function tab:CreateTextBox(textboxOptions)
            textboxOptions = textboxOptions or {}
            
            local textbox = {
                Name = textboxOptions.Name or "TextBox",
                Value = textboxOptions.Default or "",
                Placeholder = textboxOptions.Placeholder or "Enter text...",
                Callback = textboxOptions.Callback,
                Flag = textboxOptions.Flag
            }
            
            local textboxFrame = Instance.new("Frame")
            textboxFrame.Name = textboxOptions.Name
            textboxFrame.Size = UDim2.new(1, 0, 0, 48 * scaleFactor)
            textboxFrame.BackgroundColor3 = Synthesis.Theme.Surface
            textboxFrame.LayoutOrder = #tab.Elements + 1
            textboxFrame.Parent = tabContent
            Utils.ApplyCorner(textboxFrame, 8)
            
            local textboxLabel = Instance.new("TextLabel")
            textboxLabel.Size = UDim2.new(0.4, -10, 1, 0)
            textboxLabel.Position = UDim2.new(0, 15, 0, 0)
            textboxLabel.BackgroundTransparency = 1
            textboxLabel.Text = textboxOptions.Name
            textboxLabel.TextColor3 = Synthesis.Theme.TextPrimary
            textboxLabel.Font = Enum.Font.GothamMedium
            textboxLabel.TextSize = 14 * scaleFactor
            textboxLabel.TextXAlignment = Enum.TextXAlignment.Left
            textboxLabel.Parent = textboxFrame
            
            local inputBox = Instance.new("TextBox")
            inputBox.Size = UDim2.new(0.6, -25, 0, 32 * scaleFactor)
            inputBox.Position = UDim2.new(0.4, 5, 0.5, 0)
            inputBox.AnchorPoint = Vector2.new(0, 0.5)
            inputBox.BackgroundColor3 = Synthesis.Theme.SurfaceLight
            inputBox.Text = textbox.Value
            inputBox.PlaceholderText = textbox.Placeholder
            inputBox.PlaceholderColor3 = Synthesis.Theme.TextMuted
            inputBox.TextColor3 = Synthesis.Theme.TextPrimary
            inputBox.Font = Enum.Font.Gotham
            inputBox.TextSize = 13 * scaleFactor
            inputBox.ClearTextOnFocus = false
            inputBox.Parent = textboxFrame
            Utils.ApplyCorner(inputBox, 6)
            
            inputBox.FocusLost:Connect(function(enterPressed)
                textbox.Value = inputBox.Text
                
                if textboxOptions.Flag then
                    Synthesis.Flags[textboxOptions.Flag] = inputBox.Text
                end
                
                if textbox.Callback then
                    textbox.Callback(inputBox.Text, enterPressed)
                end
            end)
            
            function textbox:Set(value)
                textbox.Value = value
                inputBox.Text = value
            end
            
            table.insert(tab.Elements, textbox)
            return textbox
        end
        
        -- ==================== åˆ›å»º Label ====================
        
        function tab:CreateLabel(text)
            local label = Instance.new("TextLabel")
            label.Name = "Label"
            label.Size = UDim2.new(1, 0, 0, 25 * scaleFactor)
            label.BackgroundTransparency = 1
            label.Text = text or "Label"
            label.TextColor3 = Synthesis.Theme.TextMuted
            label.Font = Enum.Font.GothamMedium
            label.TextSize = 12 * scaleFactor
            label.TextXAlignment = Enum.TextXAlignment.Left
            label.LayoutOrder = #tab.Elements + 1
            label.Parent = tabContent
            
            local labelObj = {
                Instance = label,
                Set = function(self, newText)
                    label.Text = newText
                end
            }
            
            table.insert(tab.Elements, labelObj)
            return labelObj
        end
        
        -- ==================== åˆ›å»º Divider ====================
        
        function tab:CreateDivider()
            local divider = Instance.new("Frame")
            divider.Name = "Divider"
            divider.Size = UDim2.new(1, 0, 0, 1)
            divider.BackgroundColor3 = Synthesis.Theme.SurfaceLight
            divider.BorderSizePixel = 0
            divider.LayoutOrder = #tab.Elements + 1
            divider.Parent = tabContent
            
            return divider
        end
        
        table.insert(window.Tabs, tab)
        return tab
    end
    
    -- æ˜¾ç¤ºçª—å£ (åŠ¨ç”»)
    task.delay(0.3, function()
        window:Toggle(true)
    end)
    
    table.insert(self.Windows, window)
    return window
end

-- â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
-- â•‘                    QUICK NOTIFY                               â•‘
-- â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function Synthesis:Notify(title, content, duration, imageId)
    return NotificationSystem:Send(title, content, duration, imageId)
end

-- â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
-- â•‘              UNLOAD / PANIC / SELF-DESTRUCT                   â•‘
-- â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function Synthesis:Unload()
    if self._unloaded then return end
    self._unloaded = true
    
    print("[Synthesis] Unloading...")
    
    -- ä¿å­˜æœ€ç»ˆé…ç½®
    ConfigManager:Save({
        Flags = self.Flags,
        WindowPositions = self._savedPositions or {},
        Keybinds = self.Keybinds
    })
    
    -- æ–­å¼€æ‰€æœ‰å…¨å±€è¿æ¥
    for _, conn in pairs(self.Connections) do
        if conn and typeof(conn) == "RBXScriptConnection" then
            Utils.SafeCall(function() conn:Disconnect() end)
        end
    end
    self.Connections = {}
    
    -- é”€æ¯æ‰€æœ‰çª—å£
    for _, window in ipairs(self.Windows) do
        Utils.SafeCall(function() window:Destroy() end)
    end
    self.Windows = {}
    
    -- é”€æ¯é€šçŸ¥ç³»ç»Ÿ
    Utils.SafeCall(function() NotificationSystem:Destroy() end)
    
    -- é”€æ¯æŒ‰é”®åˆ—è¡¨
    Utils.SafeCall(function() KeybindList:Destroy() end)
    
    -- é”€æ¯ä¸»GUI (å¸¦æ·¡å‡ºåŠ¨ç”»)
    if self.ScreenGui then
        -- æ‰¾åˆ°æ‰€æœ‰CanvasGroupå¹¶æ·¡å‡º
        for _, child in ipairs(self.ScreenGui:GetDescendants()) do
            if child:IsA("CanvasGroup") then
                Utils.Tween(child, {GroupTransparency = 1}, 0.3)
            end
        end
        
        task.wait(0.35)
        
        Utils.SafeCall(function()
            self.ScreenGui:Destroy()
        end)
        self.ScreenGui = nil
    end
    
    -- æ¸…ç†æ‰€æœ‰å¼•ç”¨
    self.Flags = {}
    self.Keybinds = {}
    self._savedPositions = {}
    self._initialized = false
    
    print("[Synthesis] Unloaded successfully. Clean slate restored.")
    print("â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—")
    print("â•‘           Synthesis has been unloaded         â•‘")
    print("â•‘              Goodbye! ğŸ‘‹                      â•‘")
    print("â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
end

-- â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
-- â•‘                    RETURN LIBRARY                             â•‘
-- â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

return Synthesis


--[[
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                               â•‘
â•‘                           USAGE EXAMPLE                                       â•‘
â•‘                                                                               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

-- åŠ è½½åº“
local Synthesis = loadstring(game:HttpGet("YOUR_RAW_URL"))()

-- åˆå§‹åŒ–
local Library = Synthesis:Init({
    ConfigName = "MyScript",
    ShowWelcome = true,
    ShowKeybindList = true
})

-- åˆ›å»ºçª—å£
local Window = Library:CreateWindow({
    Name = "MainWindow",
    Title = "My Awesome Script",
    Width = 550,
    Height = 400
})

-- åˆ›å»º Combat Tab
local CombatTab = Window:CreateTab({
    Name = "Combat",
    Icon = "âš”ï¸"
})

-- æ·»åŠ  Toggle
CombatTab:CreateToggle({
    Name = "Killaura",
    Description = "Attack all nearby players",
    Default = false,
    Flag = "Killaura",
    Callback = function(value)
        print("Killaura:", value)
        if value then
            Library:Notify("âš”ï¸ Killaura", "Enabled!", 3)
        end
    end
})

-- æ·»åŠ  Slider
CombatTab:CreateSlider({
    Name = "Reach",
    Min = 3,
    Max = 20,
    Default = 5,
    Increment = 0.5,
    Flag = "Reach",
    Callback = function(value)
        print("Reach:", value)
    end
})

-- åˆ›å»º Settings Tab
local SettingsTab = Window:CreateTab({
    Name = "Settings",
    Icon = "âš™ï¸"
})

SettingsTab:CreateButton({
    Name = "Save Config",
    Icon = "ğŸ’¾",
    Primary = true,
    Callback = function()
        Library:Notify("âœ… Saved", "Configuration saved!", 3)
    end
})

SettingsTab:CreateButton({
    Name = "Unload Script",
    Icon = "ğŸš¨",
    Callback = function()
        Library:Notify("ğŸ‘‹ Goodbye", "Unloading...", 2)
        task.wait(2)
        Library:Unload()
    end
})

-- ç»‘å®šå…¨å±€æŒ‰é”®
game:GetService("UserInputService").InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end
    
    if input.KeyCode == Enum.KeyCode.RightShift then
        Window:Toggle()
    elseif input.KeyCode == Enum.KeyCode.End then
        Library:Unload()
    end
end)

print("Script loaded! Press RightShift to toggle UI, End to unload.")

]]
